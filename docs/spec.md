# 通信规范
这是一个分布式DDNS的项目，自动同步IP地址
目前还没有实现，以后再实现

## 术语表
同一设备：由用户指定的一些通信地址的集合
签名：数字签名，用于确认地址的真实性
密钥对：用于签名和验证的公钥和私钥

通信地址：域名，IPv4, IPv6, MAC等能有助于两个设备间建立通信的信息
目标设备：待获取通信地址的设备
其他设备：除本机和目标设备以外的设备

## 通信地址大类
|  类型    |  举例         |         说明        |
|:-------:|:--------------|:-------------------|
|  底层    |MAC            |                    |
|  TCP/IP |IPv4, IPv6     |较容易获取，可能经常改变 |
|  互联网  |域名            |较难获取，不容易改变    |
| 供人类使用|电子邮箱,QQ,手机号|一般需要有人介入       |
| 地理位置 |行政地址,经纬度    |                   |

## 协议包的封装
有二进制和文本两种形式  
通用包头：
|  名称 | 偏移 |  描述  |
|:----:|----:|:-------|
|  魔数 |   0 | 0xB2AD |
|  版本 |   2 | 版本号  |
| 命令块| 不定 | 见后表  |

命令块：
| 缩写  | 长度 | 编号 |  参数  | 描述                       |
|:----:|----:|-----:|:------|:--------------------------|
| GTN  |     | 0x00 |       |                           |
| GTA  |     | 0x01 |       |获取目标设备的通信地址         |
| GTS  |     | 0x02 |       |获取目标设备的签名公钥         |
| POA  |     | 0x03 |       |放置通信地址                 |
| GOA  |     | 0x04 |       |获取其他设备的通信地址         |
| GOL  |     | 0x05 |       |获取其他设备列表              |
| STAT |     | 0x06 |       |获取运行状态                 |

信息块：
| 缩写  | 长度 | 编号 |  参数  | 描述                      |
|:----:|----:|-----:|:------|:-------------------------|
| TIME |     | 0x80 |       |发送时间                    |
| HASH |     | 0x81 |       |直到最近非HASH命令块的哈希值   |
| SIGN |     | 0x82 |       |直到最近的非SIGN命令块的签名   |


## GTA请求其他通信地址
已能与目标设备通信条件时，获取其他的通信地址

## GOA中转获取通信地址
不能与目标设备通信时，通过其他设备中转得到目标设备的通信地址
